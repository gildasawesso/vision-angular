<div class="row">
  <div class="col-2">
    <div class="classrooms">
      <h3>Classes</h3>
      <div *ngFor="let classroom of classrooms; let i = index;"  class="classroom d-flex align-items-center"  [ngClass]="{'selected': selected == i}">
        <span class="flex-fill align-self-stretch d-flex align-items-center" (click)="selectClassroom(classroom, i)">{{classroom.name}}</span>
      </div>
    </div>
  </div>

  <div class="col-10" *ngIf="selected != -1">
    <div class="buttons d-flex align-items-center justify-content-end">
      <div>Exporter : </div>
      <button mat-stroked-button color="accent">Toutes les classes</button>
      <button mat-stroked-button color="accent" (click)="exportCurrentClassroom()">Classe sélectionnée</button>
    </div>
    <div class="d-flex align-items-stretch payments-state-header">
      <div>Nom</div>
      <div class="registration">
        <span>Inscription</span>
        <span class="amount">{{classroomSelected.registrationFee.amount}}</span>
      </div>
      <div class="school-fee" *ngFor="let tranche of classroomSelected.schoolFee?.tranches">
        <span>{{tranche.name}}</span>
        <span class="amount">{{tranche.amount}}</span>
      </div>
      <div class="total">Total</div>
      <div class="remaining">Total Restant</div>
    </div>

    <div class="d-flex payments-state-total">
      <div>Total</div>
      <div>{{allStudentPayments(classroomSelected.registrationFee) | spaced: 'FCFA'}}</div>
      <div *ngFor="let amount of totalPaymentsByTranche">{{amount}}</div>
      <div>{{allStudentPayments(classroomSelected.schoolFee)  | spaced: 'FCFA'}}</div>
      <div>{{(allPaymentsExpected(classroomSelected.schoolFee) - allStudentPayments(classroomSelected.schoolFee)) | spaced: 'FCFA'}}</div>
    </div>

    <div class="d-flex flex-column payments-state-body">
      <div class="my-1" *ngFor="let student of classroomStudents">
        <div class="student d-flex">
          <div>{{student?.lastname | uppercase}} {{student?.firstname}}</div>
          <div class="registration-payments" *ngFor="let pay of currentStudentRegistrationFeePayedWithReste(student)" [ngClass]="{'all-registration-fee-payments-done': pay.allPaymentsDone}">
            <div>Payée {{pay.payed}}</div>
            <div>Réduc {{pay.reduction}}</div>
            <div>Reste {{pay.reste}}</div>
          </div>
          <div class="schoolfee-payments" *ngFor="let tranche of tranchesMappedWithPayments(student)" [ngClass]="{'all-school-fee-payments-done': tranche.amount - tranche.payed == 0}">
            <div>Payée {{tranche.payed}}</div>
            <div>Reste {{tranche.amount - tranche.payed}}</div>
          </div>
          <ng-container *ngFor="let pay of currentStudentPayments(student)">
            <div class="total-payed">{{pay.payments}}</div>
            <div *ngIf="pay.reste != 0" class="total-remaining">{{pay.reste}}</div>
            <div *ngIf="pay.reste == 0" class="check-icon d-flex align-items-center">
              <img src="assets/images/good.png"/>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</div>
